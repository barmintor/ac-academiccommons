    <%
    authors = facet_items('author_facet')
    dates = facet_items('pub_date_facet')
    genre = facet_items('genre_facet')
    subject = facet_items('subject_facet')
    resource_type = facet_items('type_of_resource_facet')
    media_type = facet_items('media_type_facet')
    organization = facet_items('organization_facet')
    department = facet_items('department_facet')
    series = facet_items('series_facet')
    non_cu_series = facet_items('non_cu_series_facet')
    %>

<div style='float:left;'><h3>Common Statistics</h3></div>

<br style="clear:both"/>

<div style='padding: 0px 0px;'>
    <div style='display: table; width: 100%;'>
    	
      <div style='display: table-row; width: 100%;'>
        <div class='table-cell g_stat_head_cell' style='display: table-cell; min-width: 210px; padding: 20px 15px 15px 10px;'>
        	
        </div>
        <div class='table-cell' style='display: table-cell;  '>
        	<div style='display: table; width: ;'>
        		<div style='display: table-row;'>
					<div class='table-cell g_stat_head_cell' style='display: table-cell;'>
						    DOCS
					</div>
				 	<div class='table-cell g_stat_head_cell' style='display: table-cell;'>
				            VIEWS
					</div>
					<div class='table-cell g_stat_head_cell' style='display: table-cell;'>
				            DOWNLOADS
					</div>
					<div class='table-cell g_stat_head_cell' style='display: table-cell;'>
				            STREAMS
					</div>

				</div>		            
			</div>
		</div>  
      </div>  

       <div style='display: table-row; width: 100%;'>
        <div class='table-cell g_stat_head_cell' style='display: table-cell; min-width: 230px; padding: 20px 5px 15px 0px;'>
        	<nobr>
        	PID: 
        	&nbsp;
        	<input type="text" name="pid" style="width:80px; text-align:center" id="single-pid">
        	&nbsp;
        	<input type="submit" value=" get statistics: " onclick="get_single_stats();">
        	</nobr>
        </div>
        <div class='table-cell' style='display: table-cell;  '>
        	<div style='display: table; width: ;'>
        		<div style='display: table-row;'>
					<div id='pid-school-docs-size' class='table-cell g_stat_head_cell' style='display: table-cell;'>
						    
					</div>
				 	<div id='pid-views-size' class='table-cell g_stat_head_cell' style='display: table-cell;'>
				            
					</div>
					<div id='pid-downloads-size' class='table-cell g_stat_head_cell' style='display: table-cell;'>
				            
					</div>
					<div id='pid-streams-size' class='table-cell g_stat_head_cell' style='display: table-cell;'>
				           
					</div>

				</div>		            
			</div>
		</div>  
      </div>        
 
        <div style='display: table-row; width: 100%;'>
	        <div class='table-cell' style='display: table-cell;'>
				<hr>
	        </div>   
            <div class='table-cell' style='display: table-cell;'>
				<hr>
	        </div>  
		</div>
		
       <div style='display: table-row; width: 100%;'>
        <div class='table-cell g_stat_head_cell' style='display: table-cell; min-width: 230px; padding: 20px 5px 15px 0px;'>
<a id="search_link" href="" style=" visibility: hidden;">search link</a>
        </div>
        <div class='table-cell' style='display: table-cell;  '>
        	<div style='display: table; width: ;'>
        		<div style='display: table-row;'>
					<div id='facet-docs-size' class='table-cell g_stat_head_cell' style='display: table-cell;'>
						    
					</div>
				 	<div id='facet-views-size' class='table-cell g_stat_head_cell' style='display: table-cell;'>
				            
					</div>
					<div id='facet-downloads-size' class='table-cell g_stat_head_cell' style='display: table-cell;'>
				            
					</div>
					<div id='facet-streams-size' class='table-cell g_stat_head_cell' style='display: table-cell;'>
				           
					</div>

				</div>		            
			</div>
		</div>  
      </div> 

    </div>
    
    <style>
      .facet {
           width: 450px;
        }
    </style>

     <div style='display: table; width: 100%;'>
      
      <div style='display: table-row; width: 100%;'>
        <div class='table-cell' style='display: table-cell;  '>
			Author (<%= authors.size.to_s %>)
		</div>  
        <div class='table-cell' style='display: table-cell;  '>
 			<%= select_tag 'author_facet', options_for_select(authors), :class => 'facet', :onChange=>"javascript: hide_results();" %>
		</div>  
      </div> 
      
      <div style='display: table-row; width: 100%;'>
        <div class='table-cell' style='display: table-cell;  '>
			Date (<%= dates.size.to_s %>)
		</div>  
        <div class='table-cell' style='display: table-cell;  '>
 			<%= select_tag 'pub_date_facet', options_for_select(dates), :class => 'facet' %>
		</div>  
      </div> 
      
      <div style='display: table-row; width: 100%;'>
        <div class='table-cell' style='display: table-cell;  '>
			Content Type (<%= genre.size.to_s %>)
		</div>  
        <div class='table-cell' style='display: table-cell;  '>
 			<%= select_tag 'genre_facet', options_for_select(genre), :class => 'facet' %>
		</div>  
      </div> 
      
      <div style='display: table-row; width: 100%;'>
        <div class='table-cell' style='display: table-cell;  '>
			Subject (<%= subject.size.to_s %>)
		</div>  
        <div class='table-cell' style='display: table-cell;  '>
 			<%= select_tag 'subject_facet', options_for_select(subject), :class => 'facet' %>
		</div>  
      </div> 
      
      <div style='display: table-row; width: 100%;'>
        <div class='table-cell' style='display: table-cell;  '>
			Resource Type (<%= resource_type.size.to_s %>)
		</div>  
        <div class='table-cell' style='display: table-cell;  '>
 			<%= select_tag 'type_of_resource_facet', options_for_select(resource_type), :class => 'facet' %>
		</div>  
      </div> 
      
      <div style='display: table-row; width: 100%;'>
        <div class='table-cell' style='display: table-cell;  '>
			Media Type (<%= media_type.size.to_s %>)
		</div>  
        <div class='table-cell' style='display: table-cell;  '>
 			<%= select_tag 'media_type_facet', options_for_select(media_type), :class => 'facet' %>
		</div>  
      </div> 
      
      <div style='display: table-row; width: 100%;'>
        <div class='table-cell' style='display: table-cell;  '>
			Organization (<%= organization.size.to_s %>)
		</div>  
        <div class='table-cell' style='display: table-cell;  '>
 			<%= select_tag 'organization_facet', options_for_select(organization), :class => 'facet' %>
		</div>  
      </div> 
      
      <div style='display: table-row; width: 100%;'>
        <div class='table-cell' style='display: table-cell;  '>
			Department (<%= department.size.to_s %>)
		</div>  
        <div class='table-cell' style='display: table-cell;  '>
 			<%= select_tag 'department_facet', options_for_select(department), :class => 'facet' %>
		</div>  
      </div> 
      
      <div style='display: table-row; width: 100%;'>
        <div class='table-cell' style='display: table-cell;  '>
			Series (<%= series.size.to_s %>)
		</div>  
        <div class='table-cell' style='display: table-cell;  '>
 			<%= select_tag 'series_facet', options_for_select(series), :class => 'facet' %>
		</div>  
      </div> 
      
      <div style='display: table-row; width: 100%;'>
        <div class='table-cell' style='display: table-cell;  '>
			Non CU Series (<%= non_cu_series.size.to_s %>)
		</div>  
        <div class='table-cell' style='display: table-cell;  '>
 			<%= select_tag 'non_cu_series_facet', options_for_select(non_cu_series), :class => 'facet' %>
		</div>  
      </div> 

    </div>

</div>


<br style="clear:both"/>



	<div>
		<input type="submit" value=" get statistics: " onclick="get_facet_stats();">
	</div>


<script>
function hide_results(){
	document.getElementById( "search_link" ).style.visibility = 'hidden';
	document.getElementById( "facet-docs-size" ).style.visibility = 'hidden';
    document.getElementById( "facet-views-size" ).style.visibility = 'hidden';
    document.getElementById( "facet-downloads-size" ).style.visibility = 'hidden';
    document.getElementById( "facet-streams-size" ).style.visibility = 'hidden';
    
}

function get_facet_stats(){

	var author_facet = 'author_facet';
	var pub_date_facet = 'pub_date_facet';
	var genre_facet = 'genre_facet';
	var subject_facet = 'subject_facet';
	var type_of_resource_facet = 'type_of_resource_facet';
	var media_type_facet = 'media_type_facet';
	var organization_facet = 'organization_facet';
	var department_facet = 'department_facet';
	var series_facet = 'series_facet';
	var non_cu_series_facet = 'non_cu_series_facet';	
	
	var author_facet_value = document.getElementById( author_facet ).value;
	var pub_date_facet_value = document.getElementById( pub_date_facet ).value;
	var genre_facet_value = document.getElementById( genre_facet ).value;
	var subject_facet_value = document.getElementById( subject_facet ).value;
	var type_of_resource_facet_value = document.getElementById( type_of_resource_facet ).value;
	var media_type_facet_value = document.getElementById( media_type_facet ).value;
	var organization_facet_value = document.getElementById( organization_facet ).value;
	var department_facet_value = document.getElementById( department_facet ).value;
	var series_facet_value = document.getElementById( series_facet ).value;
	var non_cu_series_facet_value = document.getElementById( non_cu_series_facet ).value;
	
	var search_params = "";
	
	if(author_facet_value) { search_params = search_params + "&f[" + author_facet + "][]=" + author_facet_value}
	if(pub_date_facet_value) { search_params = search_params + "&f[" + pub_date_facet + "][]=" + pub_date_facet_value}
	if(genre_facet_value) { search_params = search_params + "&f[" + genre_facet + "][]=" + genre_facet_value}
	if(subject_facet_value) { search_params = search_params + "&f[" + subject_facet+ "][]=" + subject_facet_value}
	if(type_of_resource_facet_value) { search_params = search_params + "&f[" + type_of_resource_facet + "][]=" + type_of_resource_facet_value }
	if(media_type_facet_value) { search_params = search_params + "&f[" + media_type_facet + "][]=" + media_type_facet_value}
	if(organization_facet_value) { search_params = search_params + "&f[" + organization_facet + "][]=" + organization_facet_value}
	if(department_facet_value) { search_params = search_params + "&f[" + department_facet + "][]=" + department_facet_value}
	if(series_facet_value) { search_params = search_params + "&f[" + series_facet + "][]=" + series_facet_value}
	if(non_cu_series_facet_value) { search_params = search_params + "&f[" + non_cu_series_facet + "][]=" + non_cu_series_facet_value}
	
	  
	  document.getElementById( "search_link" ).style.visibility ='visible';
	  document.getElementById( "search_link" ).href = '/?' + search_params;

	  $.ajax({url: "/statistics/facet_statistics/?" + search_params + "",
           success: function(data) {
             $("#facet-docs-size").html(data);
             
			    document.getElementById( "facet-docs-size" ).style.visibility = 'visible';
			    document.getElementById( "facet-views-size" ).style.visibility = 'visible';
			    document.getElementById( "facet-downloads-size" ).style.visibility = 'visible';
			    document.getElementById( "facet-streams-size" ).style.visibility = 'visible';
           }
  });
}

function get_single_stats(){
	
	var pid = document.getElementById('single-pid').value;

  $.ajax({url: '/statistics/single_pid_stats/?event=View&pid=' + pid,
           success: function(data) {
             $("#pid-views-size").html(data);
           }
  });
  $.ajax({url: '/statistics/single_pid_stats/?event=Download&pid=' + pid,
           success: function(data) {
             $("#pid-downloads-size").html(data);
           }
  });  
  $.ajax({url: '/statistics/single_pid_stats/?event=Streaming&pid=' + pid,
           success: function(data) {
             $("#pid-streams-size").html(data);
           }
  });  
  
}
</script>
